<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Chain-api by ssfrr</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Chain-api</h1>
        <h2>RESTful sensor API</h2>
        <a href="https://github.com/ssfrr/chain-api" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="chain-api" class="anchor" href="#chain-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chain API</h1>

<h2>
<a id="news" class="anchor" href="#news" aria-hidden="true"><span class="octicon octicon-link"></span></a>News</h2>

<p>I presented ChainAPI at the Mobiquitous 2014 conference in London. You can
download the paper published in the proceedings
<a href="http://responsive.media.mit.edu/wp-content/uploads/sites/5/2013/12/ChainAPI_Mobiquitous2014_camera-ready.pdf">here</a>.</p>

<p>Slides from my recent workshop at the MIT Media Lab are available here:
<a href="http://ssfrr.github.io/ChainDinnerSpring2014/workshop_slides.html">http://ssfrr.github.io/ChainDinnerSpring2014/workshop_slides.html</a></p>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Chain API is a hypermedia HTTP API for working with sensor data. It includes an
HTTP interface supporting request/response interactions, as well as a
Websockets streaming API for realtime "push" updates.</p>

<p>This project is led by <a href="http://ssfrr.com">Spencer Russell</a>, in the
<a href="http://resenv.media.mit.edu">Responsive Environments</a> group at the <a href="http://media.mit.edu">MIT Media Lab</a>. It is
still relatively early stage and in development, and certainly not yet intended
for real production use. It is currently in use for the
<a href="http://tidmarsh.media.mit.edu">Tidmarsh Living Observatory</a> project.</p>

<p>The Chain API is built on top of the <a href="http://stateless.co/hal_specification.html">Hypertext Application Language</a>,
or HAL. Currently it only implements the application/hal+json MIME type.
hal+json is relatively simple, and clients are free to ignore HAL and treat the
responses as regular JSON data. There are also various libraries that can
take advantage of the hal+json conventions to abstract some of the details
away. For a more thorough spec of hal+json see <a href="http://tools.ietf.org/html/draft-kelly-json-hal-06">this IETF draft</a>.</p>

<p>We'll start by describing the basic JSON payloads you should expect, but also
be sure to check out the API Concept Overview for more information on the
common themes and design principles driving the API.</p>

<h2>
<a id="entry-point" class="anchor" href="#entry-point" aria-hidden="true"><span class="octicon octicon-link"></span></a>Entry Point</h2>

<p>The API entry point is at <a href="http://chain-api.media.mit.edu">http://chain-api.media.mit.edu</a>. A <code>GET</code> request
will give you a link to the available sites.</p>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span>: [
      {
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ch<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
      }
    ],
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:sites<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sites/<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Sites<span class="pl-pds">"</span></span>
    }
  }
}</pre></div>

<p>Currently the only top-level resource available is the collection of Sites.
The client first selects which site they are interested in and can navigate
from there to explore that site. Clients should not assume hard-coded URIs, but
should instead get the proper URI from the API entry point.</p>

<h1>
<a id="base-resource-types" class="anchor" href="#base-resource-types" aria-hidden="true"><span class="octicon octicon-link"></span></a>Base Resource Types</h1>

<p>NOTE: At some point this information should be moved into the docstrings of
the resources themselves, so we can generate the documentation as well as the
information at the rel URLs from the same info.</p>

<h2>
<a id="site" class="anchor" href="#site" aria-hidden="true"><span class="octicon octicon-link"></span></a>Site</h2>

<p>An installation of Chain API, usually on the scale of several or many
buildings.</p>

<h3>
<a id="resource-fields" class="anchor" href="#resource-fields" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resource Fields</h3>

<ul>
<li>
<code>name</code> (string) - Name of this site</li>
<li>
<code>geoLocation</code> (elevation, latitude, longitude) - The geographic location of
the site. All measurements are in meters.</li>
<li>
<code>ch:devices</code> (related resource) - A collection of all the devices in this
site.  New devices can be POSTed to this collection to add them to this site.</li>
</ul>

<h3>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h3>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>geoLocation<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>latitude<span class="pl-pds">"</span></span>: <span class="pl-c1">42.360624</span>,
    <span class="pl-s1"><span class="pl-pds">"</span>elevation<span class="pl-pds">"</span></span>: <span class="pl-c1">null</span>,
    <span class="pl-s1"><span class="pl-pds">"</span>longitude<span class="pl-pds">"</span></span>: <span class="pl-c1">-71.087577</span>
  },
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>ch:siteSummary<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sites/5/summary<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Summary<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>rawZMQStream<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>tcp://tidmarsh.media.mit.edu:1305<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Raw ZMQ Stream<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:devices<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/devices/?site_id=5<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Devices<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span>: [
      {
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ch<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
      }
    ],
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sites/5<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:websocketStream<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ws://chain-api.media.mit.edu/ws/site-5<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Websocket Stream<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>editForm<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sites/5/edit<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Edit Site<span class="pl-pds">"</span></span>
    }
  },
  <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>MIT Media Lab<span class="pl-pds">"</span></span>
}</pre></div>

<h2>
<a id="device" class="anchor" href="#device" aria-hidden="true"><span class="octicon octicon-link"></span></a>Device</h2>

<p>A device that may contain several sensor channels.</p>

<h3>
<a id="resource-fields-1" class="anchor" href="#resource-fields-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resource Fields</h3>

<ul>
<li>
<code>name</code> (string) - Name of this device</li>
<li>
<code>ch:site</code> (related resource) - The site this device is a part of</li>
<li>
<code>description</code> (string) - A longer description of this device</li>
<li>
<code>building</code> (string) - The building the device is in</li>
<li>
<code>floor</code> (string) - The floor of the building</li>
<li>
<code>room</code> (string) - The room containing the device</li>
<li>
<code>ch:sensors</code> (related resource) - A collection of all the sensors in this
device. New sensors can be POSTed to this collection to add them to this
device.</li>
</ul>

<h3>
<a id="example-1" class="anchor" href="#example-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h3>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>building<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>E14<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>room<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Cafe<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>floor<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>5<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>description<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>CityFarm Greenhouse (North)<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>ch:site<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sites/5<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>MIT Media Lab<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span>: [
      {
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ch<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
      }
    ],
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/devices/32<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:websocketStream<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ws://chain-api.media.mit.edu/ws/device-32<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Websocket Stream<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:sensors<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensors/?device_id=32<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Sensors<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>editForm<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/devices/32/edit<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Edit Device<span class="pl-pds">"</span></span>
    }
  },
  <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>0x8123<span class="pl-pds">"</span></span>
}</pre></div>

<h2>
<a id="sensor" class="anchor" href="#sensor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sensor</h2>

<p>A sensor captures a single channel of data. There may be multiple sensors on a
single device. Issuing a GET request for a Sensor resource also includes the
current value for that sensor. The value could be a scalar value or some other
TBD data types.</p>

<h3>
<a id="resource-fields-2" class="anchor" href="#resource-fields-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resource Fields</h3>

<ul>
<li>
<code>ch:device</code> (related resource) - The device this sensor is part of</li>
<li>
<code>ch:dataHistory</code> (related resource) - Collection of data from this sensor</li>
<li>
<code>metric</code> (string) - What the sensor is measuring (e.g. "temperature")</li>
<li>
<code>unit</code> (string) - The unit the data is in, e.g. "kW-hr". This should be an
abbreviation from the <a href="http://www.qudt.org/qudt/owl/1.0.0/unit/Instances.html">QUDT unit list</a>.</li>
<li>
<code>dataType</code> (string) - Data type of this sensor. Currently there's only <code>float</code>
</li>
<li>
<code>updated</code> (ISO8601 timestamp) - Timestamp of the most recent update</li>
<li>
<code>value</code> (various) - The most recent reading from this sensor. Currently only
floating point sensors are supported, but in the future this could be an xyz
position, GPS coordinate, image, etc.</li>
</ul>

<h3>
<a id="example-2" class="anchor" href="#example-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h3>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>updated<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>2014-04-12T20:47:15.291305+00:00<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>dataType<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>float<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>metric<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>temperature<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">22.32</span>,
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>ch:dataHistory<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensordata/?sensor_id=263<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Data<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span>: [
      {
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ch<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
      }
    ],
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensors/263<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:device<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/devices/32<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>0x8123<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>ch:websocketStream<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ws://chain-api.media.mit.edu/ws/sensor-263<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Websocket Stream<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>editForm<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensors/263/edit<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Edit Sensor<span class="pl-pds">"</span></span>
    }
  },
  <span class="pl-s1"><span class="pl-pds">"</span>unit<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>celsius<span class="pl-pds">"</span></span>
}</pre></div>

<h2>
<a id="sensor-data" class="anchor" href="#sensor-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sensor Data</h2>

<p>Sensor Data is the raw data captured by the sensors. The <code>data</code> field is a list
containing the actual data points. If necessary there are pagination links just
like collection resources. There is also a <code>createForm</code> link which gives the
URL to post data to this data set.</p>

<h3>
<a id="resource-fields-3" class="anchor" href="#resource-fields-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resource Fields</h3>

<ul>
<li>
<code>dataType</code> (string) - The type of the data, currently always "float"</li>
<li>
<code>data</code> (list) - List of data, each of which is a JSON object with at least
a <code>value</code> key and a <code>timestamp</code> key. The type of the <code>value</code> key is determined
by the <code>datatype</code> attribute</li>
<li>
<code>totalCount</code> (int) - The total number of data points in the collection. If the
total count is too large a single response may only have one page of data</li>
</ul>

<h3>
<a id="example-3" class="anchor" href="#example-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h3>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>dataType<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>float<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>totalCount<span class="pl-pds">"</span></span>: <span class="pl-c1">69148</span>,
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span>: [
      {
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>ch<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
      }
    ],
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensordata/?sensor_id=263<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>first<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensordata/?sensor_id=263&amp;limit=500&amp;offset=0<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>0 through 499<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>createForm<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensordata/create?sensor_id=263<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Add Data<span class="pl-pds">"</span></span>
    },
    <span class="pl-s1"><span class="pl-pds">"</span>previous<span class="pl-pds">"</span></span>: {
      <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://chain-api.media.mit.edu/sensordata/?sensor_id=263&amp;limit=500&amp;offset=68148<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>68148 through 68647<span class="pl-pds">"</span></span>
    }
  },
  <span class="pl-s1"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>: [
    {
      <span class="pl-s1"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>2014-04-12T15:00:04.202361+00:00<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">29.81</span>
    },
    {
      <span class="pl-s1"><span class="pl-pds">"</span>timestamp<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>2014-04-12T15:00:25.232755+00:00<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>: <span class="pl-c1">29.82</span>
    }
  ]
}</pre></div>

<h1>
<a id="general-api-concept-overview" class="anchor" href="#general-api-concept-overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>General API Concept Overview</h1>

<h2>
<a id="link-relations" class="anchor" href="#link-relations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Link Relations</h2>

<p>Given a link from one resource to another, clients generally need to know what
sort of relationship that link is modeling. Is it a link from a child to a
parent? From a device to a list of contained sensors? These relations (often
shortened to "rels") are central to the architecture of the Chain API, and
hypermedia in general.</p>

<p>Note that the <code>href</code> field in links will be a URL, which should be parsed
as per <a href="http://tools.ietf.org/html/rfc1808">RFC1808</a>. Basically this means that URLs might be absolute
(<code>http://example.com/things/392</code>) or relative to the domain (<code>/things/392</code>).
RFC1808 also allows URLs to be expressed relative to the current resource
(<code>../things/392</code>), but the Chain API does not use these.</p>

<p>Following along with standard hal+json, most rels are self-documenting, and the
rel itself actually serve as a link(URI) to the human-readable documentation
that describes what that relationship actually means. This rel URI should also
be used by clients as a unique, persistant identifier. This gives flexibility
to server implementers as they can add new relation types, or even new versions
of existing relation types, to existing resources without breaking older
clients. As long as the new rels have unique URIs, old clients will simply
ignore them.</p>

<p>Some relations are specific to the Chain API, in which case they are documented
on the Chain API site (currently chain-api.media.mit.edu). Where possible, the
API uses <a href="http://www.iana.org/assignments/link-relations/link-relations.xhtml">standard link rel names</a> in which case the rel names are
not qualified with a URI. See <a href="http://tools.ietf.org/html/rfc5988">RFC5988</a> for more info on link
relations.</p>

<p>In the Chain API attributes can also be considered relations, except the
related object is simple data, instead of a linked or embedded resource. As
such, attributes use the same self-documenting mechanism as resource relations.</p>

<h2>
<a id="curies" class="anchor" href="#curies" aria-hidden="true"><span class="octicon octicon-link"></span></a>CURIES</h2>

<p>Using URIs as relation names has the benefit of providing a stable and unique
identifier for relation names, but using a full URI as a json dictionary key is
cumbersome and duplicates lots of data in a typicaly payload. To alleviate this
issue hal+json supports Compact URIs or "CURIEs". The
<a href="http://en.wikipedia.org/wiki/CURIE">wikipedia page</a> shows an example of a CURIE used as an XML
namespace, and the <a href="http://www.w3.org/TR/curie/">w3c spec</a> has a much more detailed description.
In the context of hal+json CURIEs are simply a URI template that can be used
for each rel that references it.</p>

<h2>
<a id="embedded-relations" class="anchor" href="#embedded-relations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Embedded Relations</h2>

<p>While links are the primary way to describe relationships between resources, it
is sometimes cumbersome and inefficient to always request them separately. As
an optimization, Chain API will sometimes embed the full related resource in
addition to the link. In this case you will find the embedded resource in the
<code>_embedded</code> section of the response, which is a hal+json standard. Note that in
this case the resource will still be linked in the <code>_links</code> section with the
same rel name, so clients can ignore the <code>_embedded</code> objects if they choose.</p>

<h2>
<a id="collection-resources" class="anchor" href="#collection-resources" aria-hidden="true"><span class="octicon octicon-link"></span></a>Collection Resources</h2>

<p>Sending an HTTP GET request to a Collection Resource will return a response
with the requested resources as well as metadata about the response, such as
the total number of resources represented by this collection.  If there are
more resources than will fit into a single response, there may also be links to
the first, last, previous, and next pages.</p>

<h2>
<a id="related-collections" class="anchor" href="#related-collections" aria-hidden="true"><span class="octicon octicon-link"></span></a>Related Collections</h2>

<p>When a resource has a related collection (e.g. a parent resource has a
"children" relation), it will be represented with a collection resource.  The
resource might have "next", "previous", or "last" links to handle pagination.
If the application can add items to the collection, it can have a <code>createForm</code>
link. See the section on forms for details.</p>

<p>For instance, the following parent resource has a <code>children</code> collection:</p>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392<span class="pl-pds">"</span></span>},
    <span class="pl-s1"><span class="pl-pds">"</span>children<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children/<span class="pl-pds">"</span></span>}
  }
}</pre></div>

<p>which when followed gives you a full collection resource:</p>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children/<span class="pl-pds">"</span></span>},
    <span class="pl-s1"><span class="pl-pds">"</span>next<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children?page=2<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Page 2<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>last<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children?page=5<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Page 5<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>createForm<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children/<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Create Order<span class="pl-pds">"</span></span>},
    <span class="pl-s1"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>: [
      {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/382<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Child 1<span class="pl-pds">"</span></span>},
      {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/8371<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Child 2<span class="pl-pds">"</span></span>},
      {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/716<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Child 3<span class="pl-pds">"</span></span>}
    ]
  }
}</pre></div>

<p>Rather than the collection only containing links to the items, it may include
the items themselves embedded within the response. If you are using a HAL
client (or chainclient), then it should handle both cases (linked or embedded)
transparently and your application code shouldn't need to care. An example
with embedded items would look like:</p>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children/<span class="pl-pds">"</span></span>},
    <span class="pl-s1"><span class="pl-pds">"</span>next<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children?page=2<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Page 2<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>last<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children?page=5<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Page 5<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>createForm<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/parents/392/children/<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Create Order<span class="pl-pds">"</span></span>},
    <span class="pl-s1"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>: [
      {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/382<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Child 1<span class="pl-pds">"</span></span>},
      {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/8371<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Child 2<span class="pl-pds">"</span></span>},
      {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/716<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Child 3<span class="pl-pds">"</span></span>}
    ]
  },
  <span class="pl-s1"><span class="pl-pds">"</span>_embedded<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>: [
      {
        <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span> <span class="pl-ii">{</span>
          <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/382<span class="pl-pds">"</span></span>}
        },
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-s1"><span class="pl-pds">"</span>Child 1<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-c1">13</span>
      <span class="pl-ii">}</span>,
      {
        <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span> <span class="pl-ii">{</span>
          <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/8371<span class="pl-pds">"</span></span>}
        },
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-s1"><span class="pl-pds">"</span>Child 2<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-c1">16</span>
      <span class="pl-ii">}</span>,
      {
        <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span> <span class="pl-ii">{</span>
          <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/children/716<span class="pl-pds">"</span></span>}
        },
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-s1"><span class="pl-pds">"</span>Child 3<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span><span class="pl-ii">:</span> <span class="pl-c1">31</span>
      <span class="pl-ii">}</span>
    ]
  }
}</pre></div>

<h2>
<a id="haljson-example" class="anchor" href="#haljson-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>hal+json Example</h2>

<p>Issuing a GET to /orders might illicit the response:</p>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>next<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders?page=2<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Page 2<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>last<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders?page=5<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Page 5<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>createForm<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Create Order<span class="pl-pds">"</span></span>},
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span>: [{
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>rel<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://docs.example.com/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
    }],
    <span class="pl-s1"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>: [
        {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/123<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Christmas Order<span class="pl-pds">"</span></span>},
        {<span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/124<span class="pl-pds">"</span></span>, <span class="pl-s1"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Birthday Order<span class="pl-pds">"</span></span>},
    ]
  },
  <span class="pl-s1"><span class="pl-pds">"</span>_embedded<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>: [
    {
      <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/123<span class="pl-pds">"</span></span> },
        <span class="pl-s1"><span class="pl-pds">"</span>rel:basket<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/baskets/98712<span class="pl-pds">"</span></span> },
        <span class="pl-s1"><span class="pl-pds">"</span>rel:customer<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/customers/7809<span class="pl-pds">"</span></span> }
      },
      <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Christmas Order<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>total<span class="pl-pds">"</span></span>: <span class="pl-c1">30.00</span>,
      <span class="pl-s1"><span class="pl-pds">"</span>currency<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>USD<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>status<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>shipped<span class="pl-pds">"</span></span>,
    },
    {
      <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/124<span class="pl-pds">"</span></span> },
        <span class="pl-s1"><span class="pl-pds">"</span>rel:basket<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/baskets/97213<span class="pl-pds">"</span></span> },
        <span class="pl-s1"><span class="pl-pds">"</span>rel:customer<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/customers/12369<span class="pl-pds">"</span></span> }
      },
      <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>Birthday Order<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>total<span class="pl-pds">"</span></span>: <span class="pl-c1">20.00</span>,
      <span class="pl-s1"><span class="pl-pds">"</span>currency<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>USD<span class="pl-pds">"</span></span>,
      <span class="pl-s1"><span class="pl-pds">"</span>status<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>processing<span class="pl-pds">"</span></span>
    }]
  },
  <span class="pl-s1"><span class="pl-pds">"</span>currentlyProcessing<span class="pl-pds">"</span></span>: <span class="pl-c1">14</span>,
  <span class="pl-s1"><span class="pl-pds">"</span>shippedToday<span class="pl-pds">"</span></span>: <span class="pl-c1">20</span>
}</pre></div>

<p>Sending a GET to the URI for a specific resource will return only that
resource, e.g. GET /orders/123 might return:</p>

<div class="highlight highlight-json"><pre>{
  <span class="pl-s1"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
    <span class="pl-s1"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/orders/123<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>rel:basket<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/baskets/98712<span class="pl-pds">"</span></span> },
    <span class="pl-s1"><span class="pl-pds">"</span>rel:customer<span class="pl-pds">"</span></span>: { <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>/customers/7809<span class="pl-pds">"</span></span> }
    <span class="pl-s1"><span class="pl-pds">"</span>curies<span class="pl-pds">"</span></span><span class="pl-ii">:</span> [{
        <span class="pl-s1"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>rel<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>http://docs.example.org/rels/{rel}<span class="pl-pds">"</span></span>,
        <span class="pl-s1"><span class="pl-pds">"</span>templated<span class="pl-pds">"</span></span>: <span class="pl-c1">true</span>
    }]
  },
  <span class="pl-s1"><span class="pl-pds">"</span>rel:total<span class="pl-pds">"</span></span>: <span class="pl-c1">30.00</span>,
  <span class="pl-s1"><span class="pl-pds">"</span>rel:currency<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>USD<span class="pl-pds">"</span></span>,
  <span class="pl-s1"><span class="pl-pds">"</span>rel:status<span class="pl-pds">"</span></span>: <span class="pl-s1"><span class="pl-pds">"</span>shipped<span class="pl-pds">"</span></span>,
}</pre></div>

<h2>
<a id="posting-data" class="anchor" href="#posting-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Posting Data</h2>

<p>You'll see in the above collection payload a <code>createForm</code> rel, which is a link
that you can use to add new elements to the collection. Issuing a GET request
to the <code>createForm</code> link will return a document in <a href="http://json-schema.org/examples.html">JSON-schema</a>
format that tells the client what format the resource should take. POSTing to
the link in the proper format will create a new resource and will return it
with an HTTP 201 Created status.</p>

<h2>
<a id="editing-data" class="anchor" href="#editing-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Editing Data</h2>

<p>When the client is able to edit a resource, there will be an <code>editForm</code> rel.
As with <code>createForm</code>, sending a GET request to this URL will return a
<a href="http://json-schema.org/examples.html">JSON-schema</a> document. The default values given in the schema are
the current vaues for the resource being edited. POSTing to the URL with the
updated JSON data will update the resource.</p>

<p>Details on the <code>createForm</code> and <code>editForm</code> rels can be found in
<a href="http://tools.ietf.org/html/rfc6861">RFC6861</a>. Note that, following JSON conventions and to make things
easier on clients, we have modified the standard hyphonated rel names to
camelCase.</p>

<h2>
<a id="websockets-streaming-api" class="anchor" href="#websockets-streaming-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>Websockets Streaming API</h2>

<p>Many applications are interested in the latest data as it comes in. For these
applications constantly polling is a drain on both the client and server, so
this API implements a streaming interface via <a href="http://en.wikipedia.org/wiki/WebSocket">Websockets</a>. For
many resources you will find a <code>ch:websocketStream</code> link that you can follow
with any websocket-capable browser or client application. Once the websocket
connection is established the server will send HAL+JSON-formatted updates that
typically are the same as what you would receive in a GET response. Streams for
some resources will also include "contained" resources. For instance,
subscribing to the stream for a Site resource might also include all the
devices in that site, and even all the sensors in those devices.</p>

<p>Typically clients will start by synching their current state using the HTTP
API, and maintain a hash that maps resource URLs to the client's internal
representation. After subscribing to a stream, clients can match incoming
resource descriptions by using the <code>self</code> link as the key into the hash.</p>

<h1>
<a id="dev-server-initial-setup" class="anchor" href="#dev-server-initial-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dev Server Initial Setup</h1>

<p>To develop for Chain API the best way is with a virtual machine. The following
instructions should guide you through setting up a development environment that
should match the production machine.</p>

<p>First you'll want to make sure that both Virtualbox and Vagrant are installed,
as well as git.</p>

<p>Then clone the code from the repository with:</p>

<pre><code>git clone https://github.com/ssfrr/chain-api.git
</code></pre>

<p>Git will create a folder called chain-api and check out the code into
it.</p>

<p>from within that folder run "vagrant up" and it should instantiate the virtual
machine.</p>

<p>after the machine is up you can run "vagrant ssh" to ssh into the new VM. From
there you can follow the below instructions on setting up a Chain API server.</p>

<h1>
<a id="chain-api-server-setup-instructions" class="anchor" href="#chain-api-server-setup-instructions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chain API Server Setup Instructions</h1>

<p>Currently Chain API is supported on Ubuntu Precise (12.04 LTS)
Install dependencies with manifest.sh</p>

<pre><code>cd chain-api/
sudo chmod +x ./manifest.sh
sudo ./manifest.sh
</code></pre>

<p>NOTE FOR ARCH:</p>

<p>The puppet manifest doesn't work well on Arch, so just install the python
packages with pip system packages with pacman that are listed in the manifest,
and comment those stanzas out.  I also had to set the ownership of
/var/lib/postgres with:</p>

<pre><code>sudo chown -R postgres:users /var/lib/postgres
</code></pre>

<p>END OF ARCH-SPECIFIC NOTE</p>

<h3>
<a id="setup-postgres" class="anchor" href="#setup-postgres" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup Postgres</h3>

<pre><code>sudo su - postgres
createuser --pwprompt &lt;POSTGRES USERNAME&gt;
</code></pre>

<p>after creating a new user, you can create the postgres db like so:</p>

<pre><code>createdb chain
</code></pre>

<p>Copy <code>localsettings_template.py</code> into a new file called <code>localsettings.py</code>, setting
the username and password, as well as the <code>SECRET_KEY</code>. You can generate an
appropriate secret key in python with:</p>

<pre><code>import random
''.join([random.SystemRandom().
    choice('abcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*(-_=+)')
    for i in range(50)])
</code></pre>

<p>Before continuing, ensure that the <code>build-essential</code> package for Ubuntu is installed.  If
not (or if you are unsure), install it by running:</p>

<pre><code>sudo apt-get install build-essential
</code></pre>

<p>Check to make sure <code>libzmq-dev</code> is not installed.  The version of ZMQ found in the apt repository
is below the minimum required version for ChainAPI.  ChainAPI will install the correct version,
but only if ZMQ is not already installed on the system.  If it is installed, you can uninstall it with</p>

<pre><code>sudo apt-get remove libzmq-dev
</code></pre>

<p>Then install python dependencies like so:</p>

<pre><code>./setup.py develop
</code></pre>

<p>Now you can initialise your django environment</p>

<pre><code>./manage.py syncdb
./manage.py migrate
</code></pre>

<p>Now you should be able to run the server with:</p>

<pre><code>./manage.py runserver 0.0.0.0:8000
</code></pre>

<p>and access it from your host machine's browser at</p>

<pre><code>http://localhost:8000/admin
</code></pre>

<h2>
<a id="dev-server-vagrant-box-setup" class="anchor" href="#dev-server-vagrant-box-setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dev Server Vagrant Box Setup</h2>

<p>An alternative method to quickly start developing with chain-api on Ubuntu 12.04 Wheezy64 Vagrant Box</p>

<pre><code>curl -o package.box http://phive-yogurt.mit.edu/chain-ubuntu1404.box
vagrant box add chain-box package.box
vagrant init chain-box
vagrant up
vagrant ssh
</code></pre>

<p>default postgres username/password:</p>

<pre><code>username: yoda
password: 123
</code></pre>

<p>default http username/password:</p>

<pre><code>username: yoda
password: 123
</code></pre>

<p>Make sure to change the username/password and edit localsettings.py</p>

<p>Supervisor and Nginx are setup to run automatically, but you will have to run the following first.</p>

<pre><code>cd /vagrant
sudo su - postgres -c 'psql -c "ALTER USER yoda WITH SUPERUSER;"'
sudo ./setup.py develop
sudo ./manage.py migrate
sudo chmod -R g+wx-s /usr/local /srv
sudo chmod -R a+r /usr/local
</code></pre>

<p>Then restart supervisor and nginx:</p>

<pre><code>sudo /etc/init.d/supervisor stop
sudo /etc/init.d/supervisor start
sudo /etc/init.d/nginx restart
</code></pre>

<h2>
<a id="setting-up-for-production" class="anchor" href="#setting-up-for-production" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up for Production</h2>

<p>While the above steps should be fine for development, there are a few more
things you need to do for a production machine.</p>

<p>First make sure whatever user will be deploying is in the "staff" group. This will
allow us to autodeploy without needing root permissions.</p>

<pre><code>sudo usermod -aG staff USERNAME
sudo chown -R root:staff /usr/local /srv
sudo chmod -R g+wx-s /usr/local /srv
sudo chmod -R a+r /usr/local
</code></pre>

<p>Before continuing, ensure that the <code>build-essential</code> package for Ubuntu is installed.  If
not (or if you are unsure), install it by running:</p>

<pre><code>sudo apt-get install build-essential
</code></pre>

<p>Check to make sure <code>libzmq-dev</code> is not installed.  The version of ZMQ found in the apt repository
is below the minimum required version for ChainAPI.  ChainAPI will install the correct version,
but only if ZMQ is not already installed on the system.  If it is installed, you can uninstall it with</p>

<pre><code>sudo apt-get remove libzmq-dev
</code></pre>

<p>First install the django app to your system python install by running</p>

<pre><code>./setup.py develop
</code></pre>

<p>This will install the app as a system package, so you don't need to hard-code
paths.</p>

<p>NOTE - the package is installed WITHOUT root permissions. This is
important because if we install with root permissions the first time then we'll
need root permission on every subsequent time.</p>

<p>Then copy the system config files</p>

<pre><code>sudo cp -R system/* /
</code></pre>

<p>And enable the HTTP interface to supervisor by adding the following code to
the configuration at /etc/supervisor/supervisord.conf (setting the username
and password to whatever you want them to be)</p>

<pre><code>[inet_http_server]
port=*:9001
user=username
password=password
</code></pre>

<p>We also need to change the permissions so that anyone in the "staff" group can
manage supervisor tasks.</p>

<pre><code>[unix_http_server]
file=/var/run/supervisor.sock
chmod=0770
chown=nobody:staff
</code></pre>

<p>Now create the htpasswd file that will determine the usernames and passwords
that will be allowed to POST to your ChainAPI Instance:</p>

<pre><code>sudo htpasswd -c /var/www/mywebsite.com/.htpasswd exampleuser
</code></pre>

<p>and edit /etc/nginx/sites-available/chain.conf to add the path to your
.htpasswd file where it says <code>PATH/TO/HTPASSWD</code>.</p>

<p>Next, copy the static files (CSS, JS, static HTML, etc.) to the
webserver's static folder by running</p>

<pre><code>./manage.py collectstatic
</code></pre>

<p>Now you can restart supervisord and nginx to pick up the config changes. Note
that supervisor restart doesn't work, so it must be stopped and started.</p>

<pre><code>sudo /etc/init.d/supervisor stop
sudo /etc/init.d/supervisor start
sudo /etc/init.d/nginx restart
</code></pre>

<h2>
<a id="deploy-hooks" class="anchor" href="#deploy-hooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Deploy Hooks</h2>

<p>In the "hooks" directory you'll find a post-receive hook that should be copied
(or symlinked) into the .git/hooks directory of your deployed server. You'll also
need to run</p>

<pre><code>git config receive.denyCurrentBranch ignore
</code></pre>

<p>To allow pushes to the checked-out branch.</p>

<p>On your development machine you should now be able to set up the deployment server as a
git remote</p>

<pre><code>git remote add production ssh://deployuser@yourserver.com/deployed/repo/dir
</code></pre>

<p>then whenever you have a version to push to production just:</p>

<pre><code>git push production
</code></pre>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/ssfrr/chain-api/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/ssfrr/chain-api/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/ssfrr/chain-api"></a> is maintained by <a href="https://github.com/ssfrr">ssfrr</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-2114450-6");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
